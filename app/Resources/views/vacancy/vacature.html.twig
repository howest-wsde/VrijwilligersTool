{% extends "base.html.twig" %}

{% block title %}Vacature{% endblock %}

{% block body %}
{% if vacancy.published == 4 %}
	<h1>{{ vacancy.title }}</h1>
	<p>Deze vacature werd verwijderd.  {% if (vacancy.organisation) and app.user in vacancy.organisation.administrators %}Indien dit onterecht was en u de verwijdering ongedaan wil maken, <a href="{{ path('restore_vacancy', {'urlid': vacancy.urlId }) }}">klik dan op deze link</a>.{% endif %}</p>
{% else %}
	<article>
        <div id="vacancy_info">
		<header><h1 id="vacancy_title">{{ vacancy.title }}</h1></header>
		<div>{# TODO: dit refacteren (what's with the div's? + volgt de wireframe niet => issue #}
			<p>
				{% if vacancy.stillWanted == 0 %}
					Deze vacature is reeds ingevuld.  Momenteel worden er geen vrijwilligers meer gezocht voor dit profiel.
				{% elseif vacancy.stillWanted == 1 %}
					{{ vacancy.stillWanted }} kandidaat gezocht.
				{% else %}
					{{ vacancy.stillWanted }} kandidaten gezocht
				{% endif %}
			</p>
            <p>Ons aanbod</p>
			<p id="vacancy_description">{{ vacancy.description }}</p>
		</div>
		<div>
			{% if vacancy.startdate %}
				<p id="vacancy_startdate">Begindatum: {{ vacancy.startdate|date("Y-m-d") }}</p>
			{% endif %}
			{% if vacancy.enddate %}
				<p id="vacancy_enddate">Einddatum: {{ vacancy.enddate|date("Y-m-d") }}</p>
			{% endif %}
			{% if vacancy.organisation %}
				<p id="vacancy_organisation">Organisatie: <a href="{{ path("organisation_by_urlid", { "urlid": vacancy.organisation.urlId }) }}">{{ vacancy.organisation.name }}</a></p>
				<p id="vacancy_location">Locatie:
					<span id="location">
						<br>
						{{ vacancy.organisation.street }}
						{{ vacancy.organisation.number }}
						<br>
						{% if vacancy.organisation.bus is not null and vacancy.organisation.bus is not empty %}
							bus {{ vacancy.organisation.bus }}
						{% endif %}
						{{ vacancy.organisation.postalcode }}
						{{ vacancy.organisation.city }}
					</span>
			{% endif %}
			</p>
		</div>
		<div class="share-buttons">
			<div>
				<a href="https://twitter.com/share" class="twitter-share-button" data-url="{{ app.request.uri }}"
				   data-text="Bekijk deze vrijwilligersvacature:" data-lang="nl" data-hashtags="RoeselareVrijwilligt">
				Tweeten</a>
			</div>
			<div class="g-plus" data-action="share" data-annotation="bubble"></div>
			<div class="fb-share-button" data-href="{{ app.request.uri}}" data-layout="button_count"></div>
            <script type="IN/Share" data-counter="right"></script>
			<div>
				<button id="email">Email deze vacature</button>
			</div>
			<form action="{{ path("vacancy_pdf_by_urlid", {"urlid": vacancy.urlId }) }}" target="_blank">
				<input type="submit" value="Print deze vacature"/>
			</form>
		</div>

		<aside id="#googlemaps">
			<div>
				<button id="getRoute">Toon routebeschrijving</button>
				<div id="description" class="hidden"></div>
				<p>selecteer uw gewenste transportwijze</p>
				<div onchange="googleMapsModule.drawRoute()">
					<select id="transitMethod">
						<option value="DRIVING">Auto</option>
						<option value="BICYCLING">Fiets</option>
						<option value="WALKING">Te voet</option>
						<option value="TRANSIT">Openbaar vervoer</option>
					</select>
					<select id="transitMode" class="hidden">
						<option value="BUS">Per bus</option>
						<option value="RAIL">Per spoor (combinatie van trein, tram, metro,...)</option>
						<option value="SUBWAY">Per metro</option>
						<option value="TRAM">Per tram</option>
					</select>
				</div>
			</div>
			<div data-useraddress="
			{% if app.user %}
				{{ app.user.street }}
				{{ app.user.number }}
				{{ app.user.postalcode }}
				{{ app.user.city }}
			{% else %}
			{% endif %}"
				 id="map-canvas" style="width: 350px; height: 350px;">
			</div>
		</aside>

		<footer>{% block vacature_cta %}
			<ul>
				{% if app.user in vacancy.likers %}
					<li><a href="{{ path("vacancy_like", {'urlid': vacancy.urlId, 'likeunlike':'unlike' }) }}">Ontwaar</a></li>
				{% else %}
					<li><a href="{{ path("vacancy_like", {'urlid': vacancy.urlId, 'likeunlike':'like' }) }}">Bewaar</a></li>
				{% endif %}


				{% if app.user in vacancy.candidates %}
					<li><a href="{{ path("vacancy_unsubscribe", {'urlid': vacancy.urlId }) }}">Verwijder kandidatuur</a></li>
				{% else %}
					<li><a href="{{ path("vacancy_subscribe", {'urlid': vacancy.urlId }) }}">Stel je kandidaat</a></li>
				{% endif %}

				<li><a href="{{ path("vacancy_edit", {'urlid': vacancy.urlId }) }}">Vacature aanpassen</a></li>
				<li><a href="{{ path("vacancy_candidacies", {'urlid': vacancy.urlId }) }}">Kandidaten selecteren</a></li>

			    {% if vacancy.published != 4 and (vacancy.organisation) and app.user in vacancy.organisation.administrators %}
			        <li><a href="{{ path('delete_vacancy', {'urlid': vacancy.urlId }) }}">Vacature verwijderen</a></li>
			    {% endif %}
			</ul>
			{% endblock %}</footer>
	</article>
{% endif %}
{% endblock %}

{% block javascripts %}
	{{ parent() }}
	<script src="https://apis.google.com/js/platform.js" async defer>{lang: "nl"}</script>
	<script src="https://maps.googleapis.com/maps/api/js?key={{ googlemaps_key }}"></script>
    <script src="https://platform.linkedin.com/in.js" type="text/javascript"></script>

	<script src="{{ asset("js/googleMaps.js") }}"></script>
	<script src="{{ asset("js/sharebuttons.js") }}"></script>
{% endblock %}
